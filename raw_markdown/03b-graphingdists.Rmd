# Graphing Distributions: Histograms

 <font size="2"> Note: Portions below modeled after content from
 *Online Statistics Education: A Multimedia Course of Study* 
 (http://onlinestatbook.com/) Project Leader: David M. Lane, Rice University </font>
 
## Introduction

The "distribution" of a set of data consists of the set of possible data values and the
frequency that the values occur.
A **histogram** is a graphical method for displaying the shape of a distribution. 
It is particularly useful when there are a large number of data values, when
it is not practical to list all values. 

We begin with an example consisting of the weights of 371 bags containing a
substance suspected of being narcotics.  The weights of the bags range from
215 to 270 grams.  Below are the weights for 10 bags.  (It is not
practical to show them all.)

$$
240.91, 234.66, 246.84, 244.24, 253.39, 245.07, 228.75, 237.29, 255.69, 254.64
$$

One way to get a sense of the distribution of the weights is through the
use of a frequency table, where we organize the data into groups of similar
weights and the count the number in each group.  The results for this
data set are shown in Table 1.

$$
\begin{array}{|c|c|r|} \hline
\mathrm{Interval} & \mathrm{Interval} & \mathrm{Class}\hspace{.175in}\\
\text{Lower Limit} & \text{Upper Limit} & \mathrm{Frequency} \\ \hline
215 & 220 & 4\hspace{.3in} \\  \hline
220 & 225  & 8\hspace{.3in} \\  \hline
225 & 230 & 31\hspace{.3in} \\  \hline
230 & 235 & 74\hspace{.3in} \\  \hline
235 & 240 & 88\hspace{.3in} \\  \hline
240 & 245 & 75\hspace{.3in} \\  \hline
245 & 250 & 57\hspace{.3in} \\  \hline
250 & 255 & 25\hspace{.3in} \\  \hline
255 & 260 & 8\hspace{.3in} \\  \hline
260 & 265 & 1\hspace{.3in} \\  \hline
\end{array}\\
\mbox{Table 1: Grouped Frequency Distribution of Weights}
$$

To create this table, the range of weights was broken into *class intervals*. 
The first interval is from 215 to 220, the second from 220 to 225, and so on. Next, the number of weights
falling into each interval was counted to obtain the class frequencies. There are four weights  
in the first interval, eight in the second, etc.

Class intervals of width 5 provide enough detail about the distribution to be revealing without 
making the graph too "choppy." How one goes about choosing the widths (called "bin widths") of 
class intervals is discussed later in this section. 

In a histogram the class frequencies are represented by bars, which provides a graphical
depiction of the data.  The height of each bar corresponds 
to its class frequency. A histogram of the weight data is shown in Figure \@ref(fig:histogram).

```{r histogram, fig.cap="Histogram of weights", echo=FALSE}
set.seed(4)
data01 = rnorm(371, mean=239, sd=8)
for (i in 1:371) {
  if (data01[i] > 239) {
    data01[i] = 239 + 1.1*(data01[i]-239)
  }
}
data01 <- data.frame(Weights = data01)
ggplot(data01, aes(Weights)) + 
  geom_histogram(breaks = seq(215, 265, by=5),
                 fill = "steelblue",
                 color = "black") + 
  labs(x="Weights", y="Frequency")
```

We can see from the histogram that most of the weights are between 230 and 250 grams,
with fewer weights in the extremes.  We can also see that the distribution is not 
quite symmetric, the weights extend to the right farther than to the left.  This
distribution is therefore said to be *skewed*.

Because the weights are measured to two decimal 
places, it is not likely that we get many "fence-sitters" -- that is, values
that land right on the border between two bins.  This allows use to choose
whole numbers as boundaries, which avoids a cluttered appearance.  Computer
software generally will use this option when feasible, and sometimes automatically
labels the middle of each interval instead of the endpoints.

Histograms can be based on relative frequencies instead of actual frequencies,
showing the proportion (or percentage) of values in each interval instead of
the exact frequence.  Our weight data is displayed as percentages in 
Figure \@ref(fig:histogram-perc).  To get the percentages, we divide
each frequency by the number of data values (that gives the proportion), and
then multiply by 100 to convert to percentages.

```{r histogram-perc, fig.cap="Histogram of weights", echo=FALSE}
set.seed(4)
data01 = rnorm(371, mean=239, sd=8)
for (i in 1:371) {
  if (data01[i] > 239) {
    data01[i] = 239 + 1.1*(data01[i]-239)
  }
}
data01 <- data.frame(Weights = data01)
ggplot(data01, aes(x = Weights, y=)) + 
  geom_histogram(aes(y = 100*(..count..)/(sum(..count..))),
                 breaks = seq(215, 265, by=5),
                 fill = "steelblue",
                 color = "black") + 
  labs(x="Weights", y="Percentage")
```

We see that the shape of the histogram is unchanged, only the Y-axis is
different.

The choice of bin width determines the number of class intervals. 
This decision, along with the choice of starting point for the first interval, 
affects the shape of the histogram. In Figure \@ref(fig:histogram-two) we see
histograms for our data using bins of width 1 (left) and width 10 (right).
These both give a general sense of the distribution, but here bins of width 1
produce a graph that is too busy while bins of width 10 produce a graph that
lacks detail.

```{r histogram-two, fig.cap="Histograms with different bin widths", echo=FALSE}

# Joseph: Please create side-by-side histograms using the above data, 
# bin width 1 on the left, bin width 10 on the right
```

Most software have defaults for bin widths that might work well for a given set
of data, or might not.  There are some "rules of thumb" that can help guide
thed choice of bin width but these are just guidelines that should not be
regarded as definitive, so do not feel bound to them.  That said, here are
a couple of general guidelines you can consider:

$\bullet$ Sturges' rule is to set the number of intervals as close as possible to 
$1 + \log_2(N)$, where $\log_2(N)$ is the base 2 log of the number of 
observations $N$. For our data set of $N = 371$, we have $1 + \log_2(N) = 9.535$
which suggests 10 intervals, which happens to match our choice.

$\bullet$ The Rice rule suggests that the number of intervals should be the integer
nearest to $2\sqrt[3]{N}$, twice the cube root of the number of data values.
For $N = 371$ this formula gives $2\sqrt[3]{371} = 14.371$, which is somewhat more
that we chose.

The above rules are just a guide, you are advised to experiment with different 
numbers of intervals and choose the histogram that you feel best conveys the
shape of the distribution.

---

## Exercises

1. $\text{Put exercises here}$
